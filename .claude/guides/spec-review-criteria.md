# 스펙 리뷰 기준 정의서

이 문서는 스펙의 AI 구현 준비도를 평가하기 위한 체크 항목과 판정 기준을 정의합니다.
`spec-reviewer` 에이전트가 이 기준을 참조하여 리뷰를 수행합니다.

---

## 점수 체계

### 항목별 판정

| 판정 | 점수 | 의미 |
|------|:----:|------|
| **PASS** | 0 | 문제 없음 |
| **WARN** | 1 | 권장 수정 (구현 가능하나 품질 저하 우려) |
| **FAIL** | 3 | 반드시 수정 (구현 불가 또는 중대한 오류 우려) |

### 종합 판정

| 판정 | 조건 | 의미 |
|------|------|------|
| **READY** | FAIL 0건, WARN 2건 이하 | 구현 착수 가능 |
| **NEEDS_WORK** | FAIL 2건 이하 또는 WARN 3건 이상 | 수정 후 재리뷰 권장 |
| **NOT_READY** | FAIL 3건 이상 | 수정 필수, 재리뷰 필수 |

---

## 카테고리 1: 구조적 완성도

대상: 전체 (B/M/W)

| ID | 체크 항목 | PASS | WARN | FAIL |
|----|----------|------|------|------|
| S1 | 개요 테이블 존재 | Feature ID, 플랫폼, 상태, Part 수 포함 | 일부 필드 누락 | 개요 테이블 없음 |
| S2 | 승인 상태 명시 | 승인 상태/승인자/날짜 기록 | 승인 상태만 있고 날짜 없음 | 승인 정보 없음 |
| S3 | Part 분할 계획 | Part 수, 각 Part 범위, 예상 파일 수 명시 | Part 수만 있고 범위 불명확 | Part 계획 없음 |
| S4 | 파일 배치 힌트 | 패키지/디렉토리 + 참조 패턴 + 수정 대상 구분 | 힌트 있으나 수정 대상 구분 없음 | 배치 힌트 없음 |
| S5 | 변경 이력 섹션 | 버전, 날짜, 변경 내용 기록 | 섹션 있으나 내용 불완전 | 변경 이력 없음 |

---

## 카테고리 2: API 계약 정밀도

대상: B (Backend)

| ID | 체크 항목 | PASS | WARN | FAIL |
|----|----------|------|------|------|
| A1 | HTTP 메서드 + 경로 | 모든 API에 메서드와 경로 명시 | 일부 API에 메서드 누락 | 경로만 나열, 메서드 없음 |
| A2 | 요청 JSON 예시 | 모든 API에 요청 Body JSON 예시 포함 | 일부 API에 JSON 없음 | JSON 예시 전혀 없음 |
| A3 | 응답 JSON 예시 | 모든 API에 성공/실패 응답 JSON 포함 | 성공 응답만 있음 | 응답 JSON 없음 |
| A4 | 에러 코드 테이블 | HTTP 상태 + 에러 코드 + 메시지 테이블 | 에러 코드 있으나 메시지 누락 | 에러 처리 정의 없음 |
| A5 | 유효성 검증 규칙 | 필드별 유효성 규칙 명시 | 일부 필드만 규칙 있음 | 유효성 규칙 없음 |
| A6 | 인증/권한 요구사항 | 각 API의 인증 필요 여부, 권한 레벨 명시 | 일괄 "인증 필요" 정도 | 인증 요구사항 없음 |

---

## 카테고리 3: 데이터 모델 명확성

대상: B/M/W

| ID | 체크 항목 | PASS | WARN | FAIL |
|----|----------|------|------|------|
| D1 | 필드 테이블 정의 | 필드명, 타입, 필수여부, 설명 테이블 | 필드 목록만 있고 타입 누락 | 데이터 모델 정의 없음 |
| D2 | 관계 명시 | Entity 간 관계 (1:N, N:M 등) 명시 | 관계 언급은 있으나 방향/종류 불명확 | 관계 정의 없음 |
| D3 | DTO 구분 | 요청/응답 DTO와 Entity를 구분 | DTO가 있으나 용도 불명확 | Entity와 DTO 혼용 |
| D4 | 네이밍 일관성 | 전체 문서에서 동일 모델명 사용 | 같은 모델에 2개 이상 이름 사용 | 모델명이 혼란스러움 |

---

## 카테고리 4: 비즈니스 로직 구체성

대상: B/M

| ID | 체크 항목 | PASS | WARN | FAIL |
|----|----------|------|------|------|
| L1 | 번호 매긴 자연어 규칙 | 순서가 있는 번호 목록으로 로직 서술 | 산문체 서술 (순서 불명확) | 비즈니스 로직 미기술 |
| L2 | 엣지 케이스 정의 | 주요 예외/경계 상황 명시 | 일부 엣지 케이스만 언급 | 엣지 케이스 없음 |
| L3 | 구현 코드 미포함 | 자연어 규칙만 포함 (코드 없음) | 의사 코드 수준 포함 | 실제 구현 코드 포함 |
| L4 | 외부 시스템 연동 명시 | 연동 대상, 호출 시점, 실패 처리 정의 | 연동 대상만 언급 | 외부 연동이 있으나 정의 없음 |

---

## 카테고리 5: 테스트 시나리오 구체성

대상: 전체 (B/M/W)

| ID | 체크 항목 | PASS | WARN | FAIL |
|----|----------|------|------|------|
| T1 | 테이블 형식 | 시나리오/조건/예상결과 테이블 | 목록 형태이나 구조화 | 시나리오 없음 |
| T2 | Happy Path 포함 | 정상 흐름 시나리오 존재 | 일부 정상 흐름만 있음 | 정상 흐름 시나리오 없음 |
| T3 | Error Path 포함 | 주요 오류 케이스 시나리오 존재 | 일부 오류만 있음 | 오류 시나리오 없음 |
| T4 | 구체적 기대값 | 입력→출력 매핑이 구체적, 모호한 항목은 `⚠️` 표시 후 확정됨 | 기대값이 모호하거나 `⚠️` 미확정 항목 잔존 | "정상 동작해야 함" 수준 |

---

## 카테고리 6: UI/UX 명확성

대상: M/W (Mobile/Web)

| ID | 체크 항목 | PASS | WARN | FAIL |
|----|----------|------|------|------|
| U1 | 텍스트 와이어프레임 | 주요 화면의 레이아웃이 텍스트로 정의 | 화면 설명만 있고 와이어프레임 없음 | 화면 정의 없음 |
| U2 | 컴포넌트 목록 | 화면별 사용 컴포넌트/위젯 목록 | 컴포넌트 언급만 있음 | 컴포넌트 정의 없음 |
| U3 | 사용자 흐름 | 화면 간 네비게이션/흐름 정의 | 일부 흐름만 정의 | 흐름 정의 없음 |
| U4 | API 매핑 | 화면 동작과 호출 API 매핑 | 일부만 매핑 | API 매핑 없음 |

---

## 카테고리 7: 컨텍스트 윈도우 적합성

대상: 전체 (B/M/W)

### 토큰 버짓 참조

Sonnet 4.6 (200K 컨텍스트)가 Part 파일을 받고 구현을 완료하기까지의 토큰 배분:

| 단계 | 구성 요소 | 토큰 (추정) | 통제 주체 |
|------|----------|:-----------:|----------|
| 가이드 로드 | System + CLAUDE.md + impl-mode.md + conventions | ~15K | 프로젝트 설정 (고정) |
| **스펙 읽기** | **Part 파일** | **~3-6K (목표)** | **스펙 작성자** |
| 소스 탐색 | 기존 코드 파일 읽기 | ~40-60K | 코드베이스 크기 |
| 구현 | 코드 생성 + 테스트 실행 | ~60-80K | 구현 복잡도 |
| 오버헤드 | Tool call 왕복 | ~20-30K | - |
| 여유분 | 안전 마진 | ~15-35K | - |

스펙이 커지면 구현 단계의 예산이 줄어들어 품질 저하로 이어집니다.

### 체크 항목

| ID | 체크 항목 | PASS | WARN | FAIL |
|----|----------|------|------|------|
| C1 | Part당 크기 | ~400줄 이하 (~6K 토큰) | 400~600줄 (~6-9K 토큰, 구현 예산 압박) | 600줄 초과 (~9K+ 토큰, 구현 품질 저하 위험) |
| C2 | 섹션 자기 완결성 | 각 Part 내 섹션이 독립적으로 이해 가능 | 일부 섹션이 다른 Part 참조 필요 | Part 간 순환 참조 |
| C3 | 전체 스펙 크기 | 전체 2000줄 이하 | 2000~3000줄 | 3000줄 초과 |
| C4 | Part 수 | 4개 이하 | 5~6개 | 7개 이상 |

---

## 카테고리 8: 의존성 명확성

대상: 전체 (B/M/W)

| ID | 체크 항목 | PASS | WARN | FAIL |
|----|----------|------|------|------|
| E1 | 선행 스펙/작업 명시 | 의존하는 선행 작업이 명시되고 상태 확인 | 선행 작업 언급만 있음 | 선행 작업이 있으나 미식별 |
| E2 | 참조 패턴 명시 | 동일 구조로 생성할 기존 파일(참조 패턴) 명시 | 패키지만 있고 참조 패턴 없음 | 배치 힌트 자체가 없음 |
| E3 | 수정 대상 구분 | 신규 생성과 기존 파일 수정이 구분됨 | 구분 없이 혼합 | 배치 힌트 없음 |

---

## 카테고리 9: Part 파일 분할 적합성

대상: 전체 (B/M/W)

이 카테고리는 Part 파일 분할 시 적합성을 평가합니다.

| ID | 체크 항목 | PASS | WARN | FAIL |
|----|----------|------|------|------|
| P1 | Part 자기 완결성 | 각 Part가 독립 구현 가능 | 일부 Part 간 순환 참조 | Part 경계가 불명확 |
| P2 | 공유 데이터 모델 식별 | 공유 모델이 명시되어 Part별 복사 가능 | 공유 모델이 있으나 목록 불완전 | 공유 모델 식별 불가 |
| P3 | Part 순서/의존성 | 의존 순서 명확 (P1→P2→...) | 부분적으로 명확 | 순환 의존 또는 순서 불명 |
| P4 | Part 파일 크기 | 각 Part ~400줄 이하 예상 | 일부 Part 400~600줄 예상 | Part 600줄 초과 예상 |

---

## 카테고리 10: 기존 코드 영향 분석

대상: B (Backend)

| ID | 체크 항목 | PASS | WARN | FAIL |
|----|----------|------|------|------|
| X1 | Phase2 활성화 대상 식별 | 관련 Phase2 파일 목록과 활성화 범위 명시 | Phase2 파일 언급 있으나 검증 포인트 미기술 | Phase2 코드가 관련되나 스펙에 미식별 |
| X2 | 공유 컴포넌트 영향 명시 | SecurityConfig/ExceptionHandler 등 변경 여부 명시 (변경 없음이어도 명시) | 변경 여부 불명확 | 공유 컴포넌트 변경 필요하나 미식별 |
| X3 | 기존 엔티티 수정 위험 평가 | 레거시 스키마 매핑 제약 인지 여부 명시 | 엔티티 수정 언급 있으나 제약 검토 없음 | 레거시 엔티티 수정 필요하나 미식별 |
| X4 | 기존 DTO/서비스 충돌 확인 | 기존 DTO/서비스와의 이름·역할 충돌 없음 확인 | 유사 이름 존재하나 중복 여부 미확인 | 기존 코드와 충돌 위험 있음 |

---

## 카테고리 11: 인프라 변경 영향

대상: I (Infra/Terraform)

| ID | 체크 항목 | PASS | WARN | FAIL |
|----|----------|------|------|------|
| I1 | 변경 대상 모듈 명시 | 모듈명 + 변경 유형(신규/수정/삭제) 명확 | 모듈 언급 있으나 변경 범위 불명확 | 변경 대상 미식별 |
| I2 | 리소스 변경 상세 | 신규/수정/삭제 리소스별 설정값 명시 | 리소스 목록만 있고 설정값 누락 | 리소스 정의 없음 |
| I3 | 비용 영향 평가 | 추가 비용 예상 또는 "비용 변동 없음" 명시 | 비용 언급 없으나 무료 티어 범위 | 유료 리소스 추가인데 비용 미평가 |
| I4 | 롤백 방안 | 롤백 가능 여부 + 데이터 손실 위험 명시 | 롤백 언급만 있음 | 파괴적 변경(RDS 삭제 등)인데 롤백 미정의 |
| I5 | 서비스 영향도 | 다운타임/재배포 여부 명시 | 영향 언급 있으나 불명확 | 서비스 중단 가능성 있으나 미식별 |

---

## 안티 패턴 탐지

리뷰 시 아래 안티 패턴이 발견되면 해당 카테고리에 WARN 또는 FAIL을 부여합니다.

| 안티 패턴 | 탐지 방법 | 판정 |
|----------|----------|------|
| **구현 코드 포함** | Java/Kotlin/Dart/TypeScript 코드 블록 존재 | FAIL (L3) |
| **모호한 표현** | "적절히", "필요에 따라", "등" 등 불확정 표현 | WARN (해당 카테고리) |
| **SQL/DDL 포함** | CREATE TABLE, ALTER, INSERT 등 SQL 문 존재 | FAIL (L3) |
| **과도한 크기** | 단일 Part가 600줄 초과 | FAIL (C1) |
| **JSON 예시 없는 API** | API 정의에 요청/응답 JSON 예시 누락 | FAIL (A2/A3) |
| **에러 코드 누락** | API 정의에 에러 처리 정의 없음 | FAIL (A4) |
| **타입 없는 필드** | 데이터 모델 필드에 타입 정보 없음 | WARN (D1) |
| **테스트 없는 API** | API가 정의되었으나 대응 테스트 시나리오 없음 | WARN (T1) |
| **정확한 파일 경로 지정** | 파일명까지 지정 (디렉토리/패키지 수준이 아님) | WARN (S4) |
| **conventions 중복** | ApiResponse 구조, Exception 패턴 등 conventions에 있는 내용을 스펙에 반복 | WARN (해당 카테고리) |
| **⚠️ 미확정 기대값 잔존** | 테스트 시나리오에 `⚠️` 표시 항목이 확정되지 않은 채 남아있음 | WARN (T4) |
| **Phase2 코드 미식별** | 구현 대상 기능의 Phase2 주석 파일이 존재하나 스펙에 언급 없음 | FAIL (X1) |
| **공유 컴포넌트 영향 미분석** | 기존 코드 영향 섹션 자체가 없거나 "해당 없음" 근거 없이 누락 | WARN (X2) |
| **HCL 코드 포함** | Terraform resource/module 코드 블록 존재 | FAIL (L3) |
| **비용 미평가** | 유료 리소스 추가인데 비용 영향 섹션 없음 | WARN (I3) |
| **파괴적 변경 미식별** | RDS/S3 삭제 등 데이터 손실 가능 변경인데 롤백 방안 없음 | FAIL (I4) |

---

## 플랫폼별 적용 카테고리

리뷰 대상 플랫폼에 따라 적용하는 카테고리가 다릅니다:

| 카테고리 | B (Backend) | M (Mobile) | W (Web) | I (Infra) |
|---------|:-----------:|:----------:|:-------:|:---------:|
| 1. 구조적 완성도 | O | O | O | O |
| 2. API 계약 정밀도 | O | - | - | - |
| 3. 데이터 모델 명확성 | O | O | O | - |
| 4. 비즈니스 로직 구체성 | O | O | - | - |
| 5. 테스트 시나리오 구체성 | O | O | O | O |
| 6. UI/UX 명확성 | - | O | O | - |
| 7. 컨텍스트 윈도우 적합성 | O | O | O | O |
| 8. 의존성 명확성 | O | O | O | O |
| 9. Part 파일 분할 적합성 | O | O | O | - |
| 10. 기존 코드 영향 분석 | O | - | - | - |
| 11. 인프라 변경 영향 | - | - | - | O |

---

## 리포트 출력 형식

```markdown
# 스펙 리뷰 리포트: <Feature ID>-<기능명>-<플랫폼>

## 종합 결과

| 카테고리 | 판정 | 이슈 수 |
|---------|:----:|:------:|
| 구조적 완성도 | PASS | 0 |
| API 계약 정밀도 | WARN | 2 |
| ... | ... | ... |
| Part 파일 분할 적합성 | PASS | 0 |

**종합 판정: READY / NEEDS_WORK / NOT_READY**
**총점: X점 (FAIL: N건, WARN: N건)**

## FAIL 항목 (반드시 수정)

### [ID] 항목명
- **위치**: 스펙 내 해당 섹션
- **문제**: 구체적 문제 설명
- **수정 방안**: AI가 구현 시 필요한 정보를 어떻게 추가할지 안내

## WARN 항목 (권장 수정)

### [ID] 항목명
- **위치**: 스펙 내 해당 섹션
- **문제**: 구체적 문제 설명
- **수정 방안**: 개선 방향 안내

## Part 파일 분할 분석

- **Part 수**: N
- **공유 데이터 모델**: Model1, Model2 (N개)
- Part 1 예상 본문: ~NNN줄 (O/X)
- Part 2 예상 본문: ~NNN줄 (O/X)
- ...

## PASS 항목 요약

- [ID] 항목명: 통과 사유 한 줄 요약
- ...
```
